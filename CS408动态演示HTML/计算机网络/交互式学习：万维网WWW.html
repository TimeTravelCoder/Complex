<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº¤äº’å¼å­¦ä¹ åº”ç”¨ï¼šä¸‡ç»´ç½‘ WWW</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chosen Palette: Calm Harmony -->
    <!-- Application Structure Plan: åº”ç”¨è®¾è®¡ä¸ºå•é¡µå­¦ä¹ æ¨¡å—ï¼Œåˆ†ä¸ºâ€œæ ¸å¿ƒåŸºçŸ³â€ã€â€œåè®®è§£æâ€å’Œâ€œæ–‡æ¡£æŠ€æœ¯â€ä¸‰ä¸ªå¯¼èˆªéƒ¨åˆ†ã€‚æ ¸å¿ƒæ˜¯â€œåè®®è§£æâ€ä¸­çš„äº¤äº’å¼åŠ¨ç”»ï¼Œæ—¨åœ¨å¯è§†åŒ–HTTP/1.0å’ŒHTTP/1.1ï¼ˆæŒç»­è¿æ¥ä¸æµæ°´çº¿ï¼‰åœ¨è¯·æ±‚å¤šä¸ªå¯¹è±¡æ—¶çš„æ€§èƒ½å·®å¼‚ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡é€‰æ‹©ä¸åŒåè®®æ¨¡å¼å¹¶æ’­æ”¾åŠ¨ç”»ï¼Œç›´è§‚æ„Ÿå—RTTï¼ˆå¾€è¿”æ—¶é—´ï¼‰å¼€é”€çš„å‡å°‘å’ŒåŠ è½½æ•ˆç‡çš„æå‡ã€‚æ­¤è®¾è®¡å°†æŠ½è±¡çš„åè®®æ¦‚å¿µè½¬åŒ–ä¸ºå¯æ„ŸçŸ¥çš„è¿‡ç¨‹ï¼Œæå¤§åœ°å¢å¼ºäº†å­¦ä¹ æ•ˆæœã€‚ -->
    <!-- Visualization & Content Choices: 1. æ ¸å¿ƒåŸºçŸ³ (Goal: Inform): ä½¿ç”¨å›¾æ ‡å’Œç®€ä»‹å¡ç‰‡æ¸…æ™°å‘ˆç°URLã€HTTPã€HTMLä¸‰å¤§æ ¸å¿ƒã€‚2. HTTPåè®®è§£æ (Goal: Compare/Change): ä½¿ç”¨HTML/CSS/JSæ„å»ºä¸€ä¸ªæ—¶åºåŠ¨ç”»ï¼Œå¯è§†åŒ–TCPè¿æ¥å»ºç«‹/é‡Šæ”¾å’ŒHTTPè¯·æ±‚/å“åº”çš„è¿‡ç¨‹ã€‚é€šè¿‡ä¸‹æ‹‰èœå•åˆ‡æ¢HTTP/1.0ã€HTTP/1.1æŒç»­è¿æ¥ã€HTTP/1.1æµæ°´çº¿ä¸‰ç§æ¨¡å¼ï¼ŒåŠ¨ç”»ä¼šåŠ¨æ€å±•ç¤ºè¯·æ±‚3ä¸ªå¯¹è±¡æ‰€éœ€çš„æ€»RTTï¼Œå¹¶é€šè¿‡Chart.jsæŸ±çŠ¶å›¾æ€»ç»“å¯¹æ¯”ä¸‰ç§æ¨¡å¼çš„æ€§èƒ½ï¼Œå°†ç†è®ºä¸Šçš„æ€§èƒ½æå‡å…·ä½“åŒ–ã€‚3. æ–‡æ¡£æŠ€æœ¯ (Goal: Compare): é‡‡ç”¨å¹¶åˆ—å¡ç‰‡æ¸…æ™°å¯¹æ¯”é™æ€ã€åŠ¨æ€ã€æ´»åŠ¨ä¸‰ç§æ–‡æ¡£çš„å®šä¹‰ã€åˆ›å»ºæ–¹å¼å’Œä¼˜ç¼ºç‚¹ã€‚ (CONFIRMATION: NO SVG graphics used. NO Mermaid JS used.) -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap');
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #f8fafc; /* slate-50 */
            color: #334155; /* slate-700 */
        }
        .nav-btn {
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        .nav-btn.active {
            border-bottom-color: #0ea5e9; /* sky-500 */
            color: #0369a1; /* sky-700 */
            font-weight: 700;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
            border: 1px solid #e2e8f0;
        }
        .animate-fade-in {
            animation: fadeIn 0.6s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .timeline {
            position: relative;
            width: 100%;
            height: 450px;
            overflow: hidden;
        }
        .timeline-axis {
            position: absolute;
            height: 100%;
            width: 2px;
            background-color: #cbd5e1;
        }
        .client-axis { left: 20%; }
        .server-axis { right: 20%; }
        .timeline-label {
            position: absolute;
            top: -5px;
            transform: translateX(-50%);
            font-weight: bold;
        }
        .packet-animation {
            position: absolute;
            padding: 2px 6px;
            border-radius: 5px;
            font-size: 0.75rem;
            color: white;
            opacity: 0;
            transition: all 1.5s ease-in-out; /* Slower packet transition */
            white-space: nowrap;
        }
        .chart-container {
            position: relative; 
            width: 100%; 
            max-width: 600px; 
            margin-left: auto; 
            margin-right: auto; 
            height: 250px;
            max-height: 300px;
        }
        .speed-btn {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: all 0.2s;
            border: 1px solid #cbd5e1;
            background-color: white;
        }
        .speed-btn.active {
            background-color: #0ea5e9;
            color: white;
            border-color: #0ea5e9;
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-slate-800">äº¤äº’å¼å­¦ä¹ ï¼šä¸‡ç»´ç½‘WWW</h1>
            <p class="mt-4 text-lg text-slate-500">æ¢ç´¢æ”¯æ’‘ç°ä»£äº’è”ç½‘çš„æ ¸å¿ƒæŠ€æœ¯</p>
        </header>

        <nav class="flex justify-center border-b border-slate-200 mb-12">
            <button class="nav-btn text-lg p-4" data-tab="concepts">æ ¸å¿ƒåŸºçŸ³</button>
            <button class="nav-btn text-lg p-4" data-tab="protocol">åè®®è§£æ</button>
            <button class="nav-btn text-lg p-4" data-tab="documents">æ–‡æ¡£æŠ€æœ¯</button>
        </nav>

        <main>
            <!-- Core Concepts Section -->
            <section id="concepts" class="tab-content animate-fade-in">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold text-slate-700">ä¸‡ç»´ç½‘çš„ä¸‰å¤§æ ¸å¿ƒåŸºçŸ³</h2>
                    <p class="mt-3 text-slate-500 max-w-2xl mx-auto">ä¸‡ç»´ç½‘çš„æˆåŠŸæ„å»ºåœ¨ä¸‰ä¸ªæ ¸å¿ƒæŠ€æœ¯ä¹‹ä¸Šï¼Œå®ƒä»¬å…±åŒå®šä¹‰äº†ä¿¡æ¯çš„å®šä½ã€ä¼ è¾“å’Œå‘ˆç°æ–¹å¼ã€‚</p>
                </div>
                <div class="grid md:grid-cols-3 gap-8">
                    <div class="card p-6 text-center hover:shadow-lg hover:-translate-y-1 transition-all duration-300">
                        <div class="text-5xl mb-4">ğŸ”—</div>
                        <h3 class="text-2xl font-bold mb-2 text-sky-700">URL</h3>
                        <p class="text-slate-600"><b>ç»Ÿä¸€èµ„æºå®šä½ç¬¦</b>ï¼Œä¸ºäº’è”ç½‘ä¸Šæ¯ä¸€ä¸ªèµ„æºï¼ˆæ–‡æ¡£ã€å›¾ç‰‡ç­‰ï¼‰æä¾›å”¯ä¸€çš„åœ°å€ï¼Œè§£å†³äº†â€œå¦‚ä½•æ‰¾åˆ°ä¿¡æ¯â€çš„é—®é¢˜ã€‚</p>
                    </div>
                    <div class="card p-6 text-center hover:shadow-lg hover:-translate-y-1 transition-all duration-300">
                        <div class="text-5xl mb-4">ğŸŒ</div>
                        <h3 class="text-2xl font-bold mb-2 text-sky-700">HTTP</h3>
                        <p class="text-slate-600"><b>è¶…æ–‡æœ¬ä¼ é€åè®®</b>ï¼Œæ˜¯æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´é€šä¿¡çš„è§„åˆ™ï¼Œå®šä¹‰äº†å¦‚ä½•è¯·æ±‚å’Œä¼ è¾“ä¸‡ç»´ç½‘æ–‡æ¡£ã€‚</p>
                    </div>
                    <div class="card p-6 text-center hover:shadow-lg hover:-translate-y-1 transition-all duration-300">
                        <div class="text-5xl mb-4">ğŸ“„</div>
                        <h3 class="text-2xl font-bold mb-2 text-sky-700">HTML</h3>
                        <p class="text-slate-600"><b>è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€</b>ï¼Œç”¨äºåˆ›å»ºç½‘é¡µç»“æ„å’Œå†…å®¹ï¼Œé€šè¿‡å„ç§â€œæ ‡ç­¾â€å‘Šè¯‰æµè§ˆå™¨å¦‚ä½•æ˜¾ç¤ºä¿¡æ¯å’Œé“¾æ¥ã€‚</p>
                    </div>
                </div>
            </section>

            <!-- Protocol Section -->
            <section id="protocol" class="tab-content hidden animate-fade-in">
                 <div class="text-center mb-8">
                    <h2 class="text-3xl font-bold text-slate-700">HTTP åè®®æ€§èƒ½æ¼”è¿›</h2>
                    <p class="mt-3 text-slate-500 max-w-3xl mx-auto">HTTPåè®®æœ¬èº«æ˜¯æ— çŠ¶æ€çš„ï¼Œä½†å…¶è¿æ¥ç®¡ç†æ–¹å¼çš„æ¼”è¿›ï¼Œå¯¹ç½‘é¡µåŠ è½½é€Ÿåº¦äº§ç”Ÿäº†å†³å®šæ€§å½±å“ã€‚ä¸‹é¢æˆ‘ä»¬å°†å¯è§†åŒ–è¯·æ±‚3ä¸ªå°å›¾ç‰‡çš„è¿‡ç¨‹ï¼Œæ¥å¯¹æ¯”ä¸åŒHTTPç‰ˆæœ¬é—´çš„æ€§èƒ½å·®å¼‚ã€‚</p>
                </div>
                <div class="card p-6 md:p-8">
                    <div class="flex flex-col md:flex-row justify-center items-center gap-6 mb-8">
                        <div class="flex items-center gap-2">
                            <label for="http-version-selector" class="font-semibold whitespace-nowrap">é€‰æ‹©åè®®æ¨¡å¼:</label>
                            <select id="http-version-selector" class="p-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-sky-500 focus:border-sky-500">
                                <option value="1.0">HTTP/1.0 (éæŒç»­è¿æ¥)</option>
                                <option value="1.1-non-pipelined">HTTP/1.1 (æŒç»­è¿æ¥-éæµæ°´çº¿)</option>
                                <option value="1.1-pipelined">HTTP/1.1 (æŒç»­è¿æ¥-æµæ°´çº¿)</option>
                            </select>
                        </div>
                        <div class="flex items-center gap-2">
                             <span class="font-semibold whitespace-nowrap">åŠ¨ç”»é€Ÿåº¦:</span>
                             <div id="speed-controls" class="flex gap-1">
                                <button class="speed-btn active" data-speed="2000">æ…¢é€Ÿ</button>
                                <button class="speed-btn" data-speed="1200">ä¸­é€Ÿ</button>
                                <button class="speed-btn" data-speed="800">å¿«é€Ÿ</button>
                             </div>
                        </div>
                    </div>
                     <div class="flex justify-center items-center gap-4 mb-8">
                        <button id="play-animation" class="py-2 px-6 bg-sky-600 text-white font-semibold rounded-lg shadow-md hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-sky-400 focus:ring-opacity-75 transition-all">æ’­æ”¾åŠ¨ç”»</button>
                        <button id="reset-animation" class="py-2 px-6 bg-slate-500 text-white font-semibold rounded-lg shadow-md hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-opacity-75 transition-all">é‡ç½®</button>
                    </div>
                    
                    <div class="timeline bg-slate-100 rounded-lg border border-slate-200 p-2">
                        <div class="timeline-axis client-axis"></div>
                        <div class="timeline-label client-label" style="left: 20%;">å®¢æˆ·ç«¯ (æµè§ˆå™¨)</div>
                        <div class="timeline-axis server-axis"></div>
                        <div class="timeline-label server-label" style="left: 80%;">æœåŠ¡å™¨</div>
                        <div id="animation-packets" class="relative w-full h-full"></div>
                    </div>
                     <div id="explanation-box" class="mt-4 min-h-[3rem] p-3 bg-sky-50 text-sky-800 border-l-4 border-sky-500 rounded-r-lg">
                        <p id="explanation-text" class="font-medium">é€‰æ‹©ä¸€ä¸ªæ¨¡å¼å¹¶ç‚¹å‡»â€œæ’­æ”¾åŠ¨ç”»â€ï¼Œè§‚å¯Ÿè¯·æ±‚è¿‡ç¨‹ã€‚</p>
                    </div>
                </div>
                <div class="card p-6 md:p-8 mt-8">
                    <h3 class="text-2xl font-bold text-center mb-4 text-slate-700">æ€§èƒ½å¯¹æ¯”æ€»ç»“</h3>
                    <p class="text-center text-slate-500 mb-6">ä¸‹å›¾ç›´è§‚å±•ç¤ºäº†å®Œæˆå…¨éƒ¨3ä¸ªå¯¹è±¡è¯·æ±‚æ‰€éœ€çš„æ€»æ—¶é—´ï¼ˆä»¥RTTä¸ºå•ä½ï¼‰ã€‚</p>
                    <div class="chart-container">
                        <canvas id="performanceChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Documents Section -->
            <section id="documents" class="tab-content hidden animate-fade-in">
                 <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold text-slate-700">ä¸‡ç»´ç½‘çš„ä¸‰ç±»æ–‡æ¡£æŠ€æœ¯</h2>
                    <p class="mt-3 text-slate-500 max-w-2xl mx-auto">æ ¹æ®å†…å®¹çš„ç”Ÿæˆæ–¹å¼ï¼Œä¸‡ç»´ç½‘æ–‡æ¡£å¯ä»¥åˆ†ä¸ºé™æ€ã€åŠ¨æ€å’Œæ´»åŠ¨ä¸‰ç§ï¼Œå®ƒä»¬å„æœ‰ç‰¹ç‚¹å’Œé€‚ç”¨åœºæ™¯ã€‚</p>
                </div>
                <div class="grid md:grid-cols-3 gap-8">
                    <div class="card p-6">
                        <div class="text-5xl mb-4 text-center">ğŸ“„</div>
                        <h3 class="text-2xl font-bold mb-2 text-amber-700">é™æ€æ–‡æ¡£</h3>
                        <p class="text-slate-600 mb-4">å†…å®¹åœ¨åˆ›ä½œå®Œæ¯•åå°±å›ºå®šä¸å˜ï¼Œå­˜æ”¾åœ¨æœåŠ¡å™¨ä¸­ã€‚æ¯æ¬¡æµè§ˆå¾—åˆ°çš„ç»“æœéƒ½å®Œå…¨ç›¸åŒã€‚</p>
                        <ul class="list-disc list-inside space-y-1 text-sm text-slate-500">
                            <li><b>åˆ›å»ºæ–¹å¼:</b> ç›´æ¥ç¼–å†™HTMLæ–‡ä»¶ã€‚</li>
                            <li><b>ä¼˜ç‚¹:</b> ç®€å•ï¼Œå¯¹æœåŠ¡å™¨æ— é¢å¤–è´Ÿè½½ã€‚</li>
                            <li><b>ç¼ºç‚¹:</b> ä¸çµæ´»ï¼Œä¿¡æ¯æ›´æ–°éœ€è¦æ‰‹åŠ¨ä¿®æ”¹ã€‚</li>
                        </ul>
                    </div>
                    <div class="card p-6">
                        <div class="text-5xl mb-4 text-center">âš™ï¸</div>
                        <h3 class="text-2xl font-bold mb-2 text-amber-700">åŠ¨æ€æ–‡æ¡£</h3>
                        <p class="text-slate-600 mb-4">å†…å®¹æ˜¯åœ¨æµè§ˆå™¨è¯·æ±‚æ—¶ï¼Œç”±æœåŠ¡å™¨ä¸Šçš„åº”ç”¨ç¨‹åºåŠ¨æ€ç”Ÿæˆçš„ã€‚æ¯æ¬¡è®¿é—®éƒ½å¯èƒ½çœ‹åˆ°ä¸åŒçš„å†…å®¹ã€‚</p>
                        <ul class="list-disc list-inside space-y-1 text-sm text-slate-500">
                           <li><b>å®ç°æœºåˆ¶:</b> é€šç”¨ç½‘å…³æ¥å£(CGI)ã€‚</li>
                           <li><b>ä¼˜ç‚¹:</b> èƒ½æŠ¥å‘Šæœ€æ–°ä¿¡æ¯ï¼ˆå¦‚è‚¡ä»·ã€å¤©æ°”ï¼‰ã€‚</li>
                           <li><b>ç¼ºç‚¹:</b> å¼€å‘å¤æ‚ï¼Œå¯¹æœåŠ¡å™¨æ€§èƒ½æœ‰è¦æ±‚ã€‚</li>
                        </ul>
                    </div>
                    <div class="card p-6">
                         <div class="text-5xl mb-4 text-center">âš¡ï¸</div>
                        <h3 class="text-2xl font-bold mb-2 text-amber-700">æ´»åŠ¨æ–‡æ¡£</h3>
                        <p class="text-slate-600 mb-4">æœåŠ¡å™¨è¿”å›ä¸€æ®µç¨‹åºï¼ˆå¦‚Java Appletï¼‰ï¼Œåœ¨æµè§ˆå™¨ç«¯è¿è¡Œï¼Œå¯ä¸ç”¨æˆ·äº¤äº’å¹¶è¿ç»­æ›´æ–°æ˜¾ç¤ºã€‚</p>
                         <ul class="list-disc list-inside space-y-1 text-sm text-slate-500">
                           <li><b>è¿è¡Œä½ç½®:</b> å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰ã€‚</li>
                           <li><b>ä¼˜ç‚¹:</b> äº¤äº’æ€§å¼ºï¼Œå¯å®ç°åŠ¨ç”»ç­‰å¤æ‚æ•ˆæœã€‚</li>
                           <li><b>ç¼ºç‚¹:</b> éœ€è¦æµè§ˆå™¨æ”¯æŒï¼Œå¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ã€‚</li>
                        </ul>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tabs = document.querySelectorAll('.nav-btn');
            const contents = document.querySelectorAll('.tab-content');

            function setActiveTab(tabId) {
                tabs.forEach(tab => {
                    tab.classList.toggle('active', tab.getAttribute('data-tab') === tabId);
                });
                contents.forEach(content => {
                    content.classList.toggle('hidden', content.id !== tabId);
                });
            }

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    setActiveTab(tab.getAttribute('data-tab'));
                });
            });

            setActiveTab('concepts');

            // Animation Logic
            const playBtn = document.getElementById('play-animation');
            const resetBtn = document.getElementById('reset-animation');
            const selector = document.getElementById('http-version-selector');
            const packetsContainer = document.getElementById('animation-packets');
            const explanationText = document.getElementById('explanation-text');
            const speedControls = document.getElementById('speed-controls');
            const RTT = 60; // Base time unit for one RTT in pixels
            let animationTimeout;
            let animationSpeed = 2000; // Default speed (slowest)

            const scenarios = {
                '1.0': {
                    name: 'HTTP/1.0 (éæŒç»­è¿æ¥)',
                    steps: [
                        { time: 0, from: 'client', to: 'server', text: 'TCP SYN', color: 'bg-orange-500', explanation: '1. è¯·æ±‚å¯¹è±¡1: å»ºç«‹æ–°çš„TCPè¿æ¥ (1 RTT)ã€‚' },
                        { time: 0.5, from: 'server', to: 'client', text: 'TCP SYN/ACK', color: 'bg-orange-500' },
                        { time: 1, from: 'client', to: 'server', text: 'HTTP GET 1', color: 'bg-sky-500', explanation: '2. å‘é€HTTPè¯·æ±‚å¹¶æ¥æ”¶å“åº” (1 RTT)ã€‚' },
                        { time: 1.5, from: 'server', to: 'client', text: 'HTTP Resp 1', color: 'bg-green-500' },
                        { time: 2, from: 'client', to: 'server', text: 'TCP FIN', color: 'bg-slate-400', explanation: '3. å…³é—­TCPè¿æ¥ã€‚' },
                        
                        { time: 2.5, from: 'client', to: 'server', text: 'TCP SYN', color: 'bg-orange-500', explanation: '4. è¯·æ±‚å¯¹è±¡2: å»ºç«‹æ–°çš„TCPè¿æ¥ (1 RTT)ã€‚' },
                        { time: 3, from: 'server', to: 'client', text: 'TCP SYN/ACK', color: 'bg-orange-500' },
                        { time: 3.5, from: 'client', to: 'server', text: 'HTTP GET 2', color: 'bg-sky-500', explanation: '5. å‘é€HTTPè¯·æ±‚å¹¶æ¥æ”¶å“åº” (1 RTT)ã€‚' },
                        { time: 4, from: 'server', to: 'client', text: 'HTTP Resp 2', color: 'bg-green-500' },
                        { time: 4.5, from: 'client', to: 'server', text: 'TCP FIN', color: 'bg-slate-400', explanation: '6. å…³é—­TCPè¿æ¥ã€‚' },

                        { time: 5, from: 'client', to: 'server', text: 'TCP SYN', color: 'bg-orange-500', explanation: '7. è¯·æ±‚å¯¹è±¡3: å»ºç«‹æ–°çš„TCPè¿æ¥ (1 RTT)ã€‚' },
                        { time: 5.5, from: 'server', to: 'client', text: 'TCP SYN/ACK', color: 'bg-orange-500' },
                        { time: 6, from: 'client', to: 'server', text: 'HTTP GET 3', color: 'bg-sky-500', explanation: '8. å‘é€HTTPè¯·æ±‚å¹¶æ¥æ”¶å“åº” (1 RTT)ã€‚' },
                        { time: 6.5, from: 'server', to: 'client', text: 'HTTP Resp 3', color: 'bg-green-500' },
                        { time: 7, from: 'client', to: 'server', text: 'TCP FIN', color: 'bg-slate-400', explanation: '9. å…³é—­TCPè¿æ¥ã€‚æ€»è€—æ—¶çº¦ 6 RTTã€‚' },
                    ],
                    totalRtt: 6
                },
                '1.1-non-pipelined': {
                    name: 'HTTP/1.1 (æŒç»­è¿æ¥-éæµæ°´çº¿)',
                    steps: [
                        { time: 0, from: 'client', to: 'server', text: 'TCP SYN', color: 'bg-orange-500', explanation: '1. å»ºç«‹ä¸€ä¸ªæŒç»­TCPè¿æ¥ (1 RTT)ã€‚' },
                        { time: 0.5, from: 'server', to: 'client', text: 'TCP SYN/ACK', color: 'bg-orange-500' },
                        { time: 1, from: 'client', to: 'server', text: 'HTTP GET 1', color: 'bg-sky-500', explanation: '2. è¯·æ±‚å¯¹è±¡1å¹¶ç­‰å¾…å“åº” (1 RTT)ã€‚' },
                        { time: 1.5, from: 'server', to: 'client', text: 'HTTP Resp 1', color: 'bg-green-500' },
                        
                        { time: 2, from: 'client', to: 'server', text: 'HTTP GET 2', color: 'bg-sky-500', explanation: '3. è¿æ¥ä¿æŒï¼Œè¯·æ±‚å¯¹è±¡2å¹¶ç­‰å¾…å“åº” (1 RTT)ã€‚' },
                        { time: 2.5, from: 'server', to: 'client', text: 'HTTP Resp 2', color: 'bg-green-500' },

                        { time: 3, from: 'client', to: 'server', text: 'HTTP GET 3', color: 'bg-sky-500', explanation: '4. è¿æ¥ä¿æŒï¼Œè¯·æ±‚å¯¹è±¡3å¹¶ç­‰å¾…å“åº” (1 RTT)ã€‚' },
                        { time: 3.5, from: 'server', to: 'client', text: 'HTTP Resp 3', color: 'bg-green-500', explanation: '5. å®Œæˆæ‰€æœ‰è¯·æ±‚åå…³é—­è¿æ¥ã€‚æ€»è€—æ—¶çº¦ 4 RTTã€‚' },
                    ],
                    totalRtt: 4
                },
                '1.1-pipelined': {
                    name: 'HTTP/1.1 (æŒç»­è¿æ¥-æµæ°´çº¿)',
                    steps: [
                        { time: 0, from: 'client', to: 'server', text: 'TCP SYN', color: 'bg-orange-500', explanation: '1. å»ºç«‹ä¸€ä¸ªæŒç»­TCPè¿æ¥ (1 RTT)ã€‚' },
                        { time: 0.5, from: 'server', to: 'client', text: 'TCP SYN/ACK', color: 'bg-orange-500' },
                        { time: 1, from: 'client', to: 'server', text: 'HTTP GET 1', color: 'bg-sky-500', explanation: '2. å®¢æˆ·ç«¯è¿ç»­å‘é€æ‰€æœ‰è¯·æ±‚ï¼Œæ— éœ€ç­‰å¾…å“åº”ã€‚' },
                        { time: 1.1, from: 'client', to: 'server', text: 'HTTP GET 2', color: 'bg-sky-500' },
                        { time: 1.2, from: 'client', to: 'server', text: 'HTTP GET 3', color: 'bg-sky-500' },
                        
                        { time: 1.5, from: 'server', to: 'client', text: 'HTTP Resp 1', color: 'bg-green-500', explanation: '3. æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œè¿ç»­å‘å›æ‰€æœ‰å“åº”ã€‚' },
                        { time: 1.7, from: 'server', to: 'client', text: 'HTTP Resp 2', color: 'bg-green-500' },
                        { time: 1.9, from: 'server', to: 'client', text: 'HTTP Resp 3', color: 'bg-green-500', explanation: '4. å®Œæˆæ‰€æœ‰è¯·æ±‚åå…³é—­è¿æ¥ã€‚æ€»è€—æ—¶çº¦ 2 RTTã€‚' },
                    ],
                    totalRtt: 2
                }
            };
            
            function resetAnimation() {
                clearTimeout(animationTimeout);
                packetsContainer.innerHTML = '';
                explanationText.textContent = 'é€‰æ‹©ä¸€ä¸ªæ¨¡å¼å¹¶ç‚¹å‡»â€œæ’­æ”¾åŠ¨ç”»â€ï¼Œè§‚å¯Ÿè¯·æ±‚è¿‡ç¨‹ã€‚';
                playBtn.disabled = false;
            }
            
            function playAnimation() {
                resetAnimation();
                playBtn.disabled = true;

                const selectedScenario = scenarios[selector.value];
                explanationText.textContent = 'åŠ¨ç”»å¼€å§‹...';
                
                selectedScenario.steps.forEach((step, index) => {
                    animationTimeout = setTimeout(() => {
                        if (step.explanation) {
                           explanationText.textContent = step.explanation;
                        }
                        const packet = document.createElement('div');
                        packet.className = `packet-animation ${step.color}`;
                        packet.textContent = step.text;
                        packetsContainer.appendChild(packet);

                        const startPos = (step.from === 'client') ? '20%' : '80%';
                        const endPos = (step.to === 'client') ? '20%' : '80%';
                        const topPos = step.time * RTT + 20;

                        packet.style.top = `${topPos}px`;
                        packet.style.left = startPos;
                        packet.style.opacity = '1';

                        setTimeout(() => {
                            packet.style.left = endPos;
                            if (step.from === 'client') {
                                packet.style.transform = 'translateX(-100%)';
                            }
                        }, 50);
                        
                        if (index === selectedScenario.steps.length - 1) {
                            playBtn.disabled = false;
                            updateChartData(selectedScenario.name, selectedScenario.totalRtt);
                        }

                    }, step.time * animationSpeed);
                });
            }

            playBtn.addEventListener('click', playAnimation);
            resetBtn.addEventListener('click', resetAnimation);

            speedControls.addEventListener('click', (e) => {
                if(e.target.classList.contains('speed-btn')) {
                    animationSpeed = parseInt(e.target.dataset.speed, 10);
                    document.querySelectorAll('.speed-btn').forEach(btn => btn.classList.remove('active'));
                    e.target.classList.add('active');
                }
            });

            // Chart.js Logic
            const ctx = document.getElementById('performanceChart').getContext('2d');
            const performanceChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'æ€»è€—æ—¶ (RTTä¸ºå•ä½)',
                        data: [],
                        backgroundColor: [
                            'rgba(239, 68, 68, 0.6)',
                            'rgba(249, 115, 22, 0.6)',
                            'rgba(16, 185, 129, 0.6)'
                        ],
                        borderColor: [
                             'rgba(239, 68, 68, 1)',
                            'rgba(249, 115, 22, 1)',
                            'rgba(16, 185, 129, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'å¾€è¿”æ—¶é—´ (RTT)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });

            function updateChartData(label, value) {
                const labels = performanceChart.data.labels;
                const data = performanceChart.data.datasets[0].data;
                
                const existingIndex = labels.indexOf(label);
                if (existingIndex > -1) {
                    data[existingIndex] = value;
                } else {
                    labels.push(label);
                    data.push(value);
                }
                performanceChart.update();
            }
        });
    </script>
</body>
</html>
