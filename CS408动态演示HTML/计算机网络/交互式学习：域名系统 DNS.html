<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº¤äº’å¼å­¦ä¹ åº”ç”¨ï¼šåŸŸåç³»ç»ŸDNS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Scholarly Blue (Background: #F8FAFC, Text: #334155, Primary: #3B82F6, Accent: #10B981) -->
    <!-- Application Structure Plan: æœ¬åº”ç”¨è®¾è®¡ä¸ºä¸€ä¸ªå•é¡µåº”ç”¨ï¼ŒåŒ…å«ä¸‰ä¸ªæ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼Œé€šè¿‡é¡¶éƒ¨çš„é€‰é¡¹å¡å¯¼èˆªè¿›è¡Œåˆ‡æ¢ã€‚1. â€œåŸºç¡€æ¦‚è¿°â€æ¨¡å—ï¼šä½¿ç”¨ä¿¡æ¯å¡ç‰‡æ¸…æ™°å‘ˆç°DNSçš„æ ¸å¿ƒå®šä¹‰ä¸ä½œç”¨ã€‚2. â€œåŸŸåç©ºé—´â€æ¨¡å—ï¼šå°†è¯¾æœ¬ä¸­çš„é™æ€åŸŸåæ ‘ï¼ˆå›¾6-1ï¼‰è½¬åŒ–ä¸ºä¸€ä¸ªäº¤äº’å¼ã€å¯ç‚¹å‡»æ¢ç´¢çš„HTMLç»“æ„å›¾ï¼Œç”¨æˆ·ç‚¹å‡»ä¸åŒå±‚çº§çš„åŸŸåå¯è·å¾—ç›¸åº”è§£é‡Šã€‚3. â€œè§£æè¿‡ç¨‹â€æ¨¡å—ï¼šè¿™æ˜¯åº”ç”¨çš„æ ¸å¿ƒã€‚å®ƒå°†è¯¾æœ¬ä¸­çš„æŸ¥è¯¢æµç¨‹ï¼ˆå›¾6-5ï¼‰è½¬åŒ–ä¸ºä¸€ä¸ªåˆ†æ­¥åŠ¨ç”»ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡æŒ‰é’®è§¦å‘â€œè¿­ä»£æŸ¥è¯¢â€å’Œâ€œé€’å½’æŸ¥è¯¢â€çš„å®Œæ•´åŠ¨ç”»è¿‡ç¨‹ï¼Œç›´è§‚åœ°ç†è§£ä¸¤ç§æŸ¥è¯¢æ–¹å¼çš„åŒºåˆ«ï¼Œæå¤§åœ°æå‡äº†å­¦ä¹ æ•ˆæœã€‚ -->
    <!-- Visualization & Content Choices: 1. æ¦‚è¿° (Goal: Inform): ä½¿ç”¨Tailwind CSSæ„å»ºçš„å¡ç‰‡å¸ƒå±€ï¼Œå°†å…³é”®å®šä¹‰ï¼ˆä»€ä¹ˆæ˜¯DNSï¼Œä¸ºä»€ä¹ˆéœ€è¦DNSï¼‰åˆ†ç‚¹å‘ˆç°ï¼Œå¢å¼ºå¯è¯»æ€§ã€‚2. åŸŸåç©ºé—´ (Goal: Organize/Explore): ä½¿ç”¨åµŒå¥—çš„HTMLåˆ—è¡¨(`ul`, `li`)å’ŒTailwind CSSæ„å»ºä¸€ä¸ªå¯è§†åŒ–çš„ã€å¯äº¤äº’çš„åŸŸåæ ‘ï¼Œæ›¿ä»£é™æ€å›¾ç‰‡ã€‚äº¤äº’é€šè¿‡JavaScriptå®ç°ï¼Œç‚¹å‡»èŠ‚ç‚¹ä¼šæ˜¾ç¤ºç›¸å…³ä¿¡æ¯ã€‚3. è§£æè¿‡ç¨‹ (Goal: Compare/Explain Process): ä½¿ç”¨HTML/CSSå’ŒJavaScriptåˆ›å»ºä¸€ä¸ªåŠ¨æ€çš„ã€åˆ†æ­¥çš„åŠ¨ç”»æ¼”ç¤ºã€‚ç”¨divä»£è¡¨å„ä¸ªæœåŠ¡å™¨ï¼Œå¹¶ä¸ºå…¶åˆ†é…äº†å…·ä½“çš„IPåœ°å€ã€‚é€šè¿‡JSæ§åˆ¶æŠ¥æ–‡å›¾æ ‡çš„ç§»åŠ¨å’Œæ–‡æœ¬çš„æ›´æ–°ï¼Œæ¥æ¨¡æ‹ŸDNSæŸ¥è¯¢æŠ¥æ–‡çš„æµåŠ¨ã€‚è¿™å°†æ˜¯æœ€å…·â€œWowâ€æ•ˆæœçš„éƒ¨åˆ†ã€‚(CONFIRMATION: NO SVG graphics used. NO Mermaid JS used.) -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap');
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #F8FAFC;
            color: #334155;
        }
        .tab-btn.active {
            border-bottom-color: #3B82F6;
            color: #1E3A8A;
            font-weight: 700;
        }
        .tab-btn {
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.05), 0 2px 4px -2px rgb(0 0 0 / 0.05);
            border: 1px solid #E2E8F0;
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Domain Tree Styles */
        .domain-tree ul { padding-left: 2rem; border-left: 2px solid #D1D5DB; }
        .domain-tree li { position: relative; padding: 0.25rem 0 0.25rem 1rem; }
        .domain-tree li::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            width: 1rem;
            height: 2px;
            background-color: #D1D5DB;
            transform: translateY(-50%);
        }
        .tree-node {
            cursor: pointer;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            transition: background-color 0.2s, color 0.2s;
        }
        .tree-node:hover {
            background-color: #EFF6FF;
            color: #1D4ED8;
        }
        /* DNS Query Animation */
        .dns-server {
            border: 2px solid #D1D5DB;
            border-radius: 0.5rem;
            padding: 0.75rem;
            text-align: center;
            background-color: #F9FAFB;
            transition: all 0.3s ease;
            position: relative;
        }
        .dns-server.active {
            border-color: #3B82F6;
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.4);
            transform: scale(1.05);
        }
        .ip-address {
            font-family: monospace;
            font-size: 0.75rem;
            color: #64748B;
            background-color: #E2E8F0;
            padding: 0.1rem 0.4rem;
            border-radius: 0.25rem;
            margin-top: 0.5rem;
            display: inline-block;
        }
        .message-packet {
            position: absolute;
            transition: all 1.2s cubic-bezier(0.4, 0, 0.6, 1);
            opacity: 0;
            transform: scale(0.8);
            z-index: 10;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.8rem;
            color: white;
            white-space: nowrap;
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-5xl font-bold text-slate-800">äº¤äº’å¼å­¦ä¹ ï¼šåŸŸåç³»ç»Ÿ DNS</h1>
            <p class="mt-3 text-lg text-slate-500">æ·±å…¥ç†è§£äº’è”ç½‘çš„åœ°å€ç°¿å¦‚ä½•å·¥ä½œ</p>
        </header>

        <nav class="flex justify-center border-b border-slate-200 mb-10">
            <button class="tab-btn py-3 px-6 text-lg" data-tab="overview">åŸºç¡€æ¦‚è¿°</button>
            <button class="tab-btn py-3 px-6 text-lg" data-tab="structure">åŸŸåç©ºé—´</button>
            <button class="tab-btn py-3 px-6 text-lg" data-tab="resolution">è§£æè¿‡ç¨‹</button>
        </nav>

        <main>
            <!-- åŸºç¡€æ¦‚è¿° Section -->
            <section id="overview" class="tab-content animate-fade-in">
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="card p-6 md:p-8">
                        <h2 class="text-2xl font-bold mb-4 text-blue-700">ä»€ä¹ˆæ˜¯DNSï¼Ÿ</h2>
                        <p class="text-slate-600 leading-relaxed">
                            <span class="font-semibold text-slate-700">åŸŸåç³»ç»Ÿ DNS (Domain Name System)</span> æ˜¯äº’è”ç½‘ä½¿ç”¨çš„æ ¸å¿ƒå‘½åç³»ç»Ÿã€‚å®ƒçš„ä¸»è¦åŠŸèƒ½ï¼Œå°±æ˜¯æŠŠäººä»¬å®¹æ˜“è®°å¿†çš„<span class="font-semibold text-slate-700">åŸŸå</span>ï¼ˆå¦‚ `www.google.com`ï¼‰ï¼Œè½¬æ¢ä¸ºæœºå™¨èƒ½å¤Ÿè¯†åˆ«çš„ <span class="font-semibold text-slate-700">IPåœ°å€</span>ï¼ˆå¦‚ `172.217.160.68`ï¼‰ã€‚å¯ä»¥å°†DNSç†è§£ä¸ºæ•´ä¸ªäº’è”ç½‘çš„ç”µè¯ç°¿ã€‚
                        </p>
                    </div>
                     <div class="card p-6 md:p-8">
                        <h2 class="text-2xl font-bold mb-4 text-blue-700">ä¸ºä»€ä¹ˆéœ€è¦DNSï¼Ÿ</h2>
                        <p class="text-slate-600 leading-relaxed">
                            ç”±äºäº’è”ç½‘è§„æ¨¡å·¨å¤§ï¼Œä¾èµ–å•ä¸ªä¸­å¤®æœåŠ¡å™¨æ¥ç®¡ç†æ‰€æœ‰åŸŸåæ˜¯ä¸å¯è¡Œçš„ï¼Œè¿™ä¼šé€ æˆæ€§èƒ½ç“¶é¢ˆå’Œå•ç‚¹æ•…éšœã€‚å› æ­¤ï¼ŒDNSè¢«è®¾è®¡æˆä¸€ä¸ªé‡‡ç”¨å®¢æˆ·æœåŠ¡å™¨æ–¹å¼çš„ <span class="font-semibold text-slate-700">è”æœºåˆ†å¸ƒå¼æ•°æ®åº“ç³»ç»Ÿ</span>ï¼Œå…·æœ‰é«˜å¯ç”¨æ€§å’Œé«˜æ•ˆç‡ã€‚
                        </p>
                    </div>
                </div>
                 <div class="card p-6 md:p-8 mt-8">
                    <h2 class="text-2xl font-bold mb-4 text-blue-700">åŸºæœ¬å·¥ä½œæ–¹å¼</h2>
                    <ol class="list-decimal list-inside space-y-3 text-slate-600">
                        <li><span class="font-semibold text-slate-700">å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼š</span> å½“ç”¨æˆ·åœ¨æµè§ˆå™¨è¾“å…¥ä¸€ä¸ªåŸŸåæ—¶ï¼Œç”¨æˆ·çš„è®¡ç®—æœºä¼šè°ƒç”¨ä¸€ä¸ª<span class="font-semibold">è§£æç¨‹åº(resolver)</span>ï¼Œå¹¶å‘<span class="font-semibold">æœ¬åœ°åŸŸåæœåŠ¡å™¨</span>å‘é€ä¸€ä¸ªDNSæŸ¥è¯¢è¯·æ±‚ã€‚</li>
                        <li><span class="font-semibold text-slate-700">æœ¬åœ°åŸŸåæœåŠ¡å™¨å“åº”ï¼š</span> æœ¬åœ°åŸŸåæœåŠ¡å™¨é¦–å…ˆæ£€æŸ¥è‡ªå·±çš„ç¼“å­˜ã€‚å¦‚æœæ‰¾åˆ°å¯¹åº”çš„IPåœ°å€ï¼Œå°±ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li>
                        <li><span class="font-semibold text-slate-700">å‘å¤–æŸ¥è¯¢ï¼š</span> å¦‚æœæœ¬åœ°åŸŸåæœåŠ¡å™¨æ— æ³•è§£æï¼Œå®ƒä¼šä»¥DNSå®¢æˆ·çš„èº«ä»½ï¼Œå‘æ›´é«˜å±‚æ¬¡çš„åŸŸåæœåŠ¡å™¨ï¼ˆå¦‚æ ¹åŸŸåæœåŠ¡å™¨ï¼‰å‘å‡ºæŸ¥è¯¢è¯·æ±‚ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯èƒ½ä¼šæ¶‰åŠå¤šä¸ªæœåŠ¡å™¨ä¹‹é—´çš„äº¤äº’ã€‚</li>
                        <li><span class="font-semibold text-slate-700">è¿”å›æœ€ç»ˆç»“æœï¼š</span> æœ¬åœ°åŸŸåæœåŠ¡å™¨åœ¨è·å¾—æœ€ç»ˆçš„IPåœ°å€åï¼Œä¼šå°†å…¶è¿”å›ç»™ç”¨æˆ·çš„è®¡ç®—æœºï¼ŒåŒæ—¶ç¼“å­˜è¿™ä¸ªç»“æœä»¥å¤‡åç»­æŸ¥è¯¢ã€‚</li>
                    </ol>
                </div>
            </section>

            <!-- åŸŸåç©ºé—´ Section -->
            <section id="structure" class="tab-content hidden animate-fade-in">
                <div class="flex flex-col lg:flex-row gap-8">
                    <div class="lg:w-1/2 card p-6">
                        <h2 class="text-2xl font-bold mb-4 text-slate-800">åŸŸåçš„å±‚æ¬¡ç»“æ„</h2>
                        <div class="domain-tree text-slate-700">
                            <ul>
                                <li>
                                    <span class="font-bold text-lg tree-node" data-info="åŸŸåæ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œè™½ç„¶å­˜åœ¨ï¼Œä½†æ²¡æœ‰åç§°ã€‚">æ ¹ (Root)</span>
                                    <ul>
                                        <li><span class="tree-node font-semibold" data-info="é€šç”¨é¡¶çº§åŸŸå(gTLD)ï¼šä»£è¡¨ç‰¹å®šçš„ç»„ç»‡ç±»åˆ«ï¼Œå¦‚ .com ä»£è¡¨å•†ä¸šå…¬å¸ã€‚">.com</span>
                                            <ul>
                                                <li><span class="tree-node" data-info="äºŒçº§åŸŸåï¼šé€šå¸¸æ˜¯ç»„ç»‡æˆ–å…¬å¸çš„åç§°ï¼Œå¦‚ cctv (ä¸­å¤®ç”µè§†å°)ã€‚">cctv</span>
                                                    <ul>
                                                         <li><span class="tree-node" data-info="ä¸‰çº§åŸŸåï¼šç”±äºŒçº§åŸŸåçš„æ‰€æœ‰è€…è‡ªè¡Œåˆ†é…ï¼Œå¸¸ç”¨äºæ ‡è¯†ç‰¹å®šçš„æœåŠ¡æˆ–ä¸»æœºï¼Œå¦‚ mail (é‚®ä»¶æœåŠ¡å™¨)ã€‚">mail</span></li>
                                                         <li><span class="tree-node" data-info="ä¸‰çº§åŸŸåï¼šwww å¸¸ç”¨äºæ ‡è¯†ç½‘ç«™æœåŠ¡å™¨ã€‚">www</span></li>
                                                    </ul>
                                                </li>
                                                <li><span class="tree-node" data-info="äºŒçº§åŸŸåï¼šå¦‚ ibmã€‚">ibm</span></li>
                                            </ul>
                                        </li>
                                        <li><span class="tree-node font-semibold" data-info="å›½å®¶ä»£ç é¡¶çº§åŸŸå(ccTLD)ï¼šä»£è¡¨ç‰¹å®šçš„å›½å®¶æˆ–åœ°åŒºï¼Œå¦‚ .cn ä»£è¡¨ä¸­å›½ã€‚">.cn</span>
                                            <ul>
                                                <li><span class="tree-node" data-info="äºŒçº§åŸŸåï¼ˆç±»åˆ«ï¼‰ï¼šå¦‚ .edu.cn ä»£è¡¨ä¸­å›½çš„æ•™è‚²æœºæ„ã€‚">edu</span>
                                                     <ul>
                                                         <li><span class="tree-node" data-info="ä¸‰çº§åŸŸåï¼šå¦‚ tsinghua (æ¸…åå¤§å­¦)ã€‚">tsinghua</span></li>
                                                         <li><span class="tree-node" data-info="ä¸‰çº§åŸŸåï¼šå¦‚ pku (åŒ—äº¬å¤§å­¦)ã€‚">pku</span></li>
                                                    </ul>
                                                </li>
                                                 <li><span class="tree-node" data-info="äºŒçº§åŸŸåï¼ˆè¡Œæ”¿åŒºåŸŸï¼‰ï¼šå¦‚ .bj.cn ä»£è¡¨åŒ—äº¬å¸‚ã€‚">bj</span></li>
                                            </ul>
                                        </li>
                                        <li><span class="tree-node font-semibold" data-info="é€šç”¨é¡¶çº§åŸŸå(gTLD)ï¼šå¦‚ .org ä»£è¡¨éè¥åˆ©ç»„ç»‡ã€‚">.org</span></li>
                                        <li><span class="font-mono text-slate-500">...</span></li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="lg:w-1/2">
                         <div id="domain-info" class="card p-6 min-h-[200px] sticky top-8">
                            <h3 class="text-xl font-bold text-blue-700 mb-2">æ¢ç´¢åŸŸåç©ºé—´</h3>
                            <p class="text-slate-600">ç‚¹å‡»å·¦ä¾§æ ‘çŠ¶å›¾ä¸­çš„ä»»æ„åŸŸåèŠ‚ç‚¹ï¼Œæ­¤å¤„å°†æ˜¾ç¤ºå…¶è¯¦ç»†ä¿¡æ¯ã€‚</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- è§£æè¿‡ç¨‹ Section -->
            <section id="resolution" class="tab-content hidden animate-fade-in">
                 <div class="card p-6 md:p-8">
                    <h2 class="text-2xl md:text-3xl font-bold mb-2 text-center text-slate-800">åŸŸåè§£æè¿‡ç¨‹å¯è§†åŒ–</h2>
                    <p class="text-center text-slate-500 mb-8">æ¨¡æ‹ŸæŸ¥è¯¢åŸŸå `y.abc.com` çš„IPåœ°å€è¿‡ç¨‹</p>
                    
                    <div id="dns-animation-container" class="relative mb-6 p-4 border border-slate-200 rounded-lg bg-slate-50/50 min-h-[400px]">
                        <div class="grid grid-cols-5 gap-4">
                            <div class="dns-server" id="client"><span class="text-xl">ğŸ’»</span><br>ä¸»æœº<div class="ip-address">192.168.1.101</div></div>
                            <div class="dns-server" id="local"><span class="text-xl">ğŸ¢</span><br>æœ¬åœ°åŸŸåæœåŠ¡å™¨<div class="ip-address">114.114.114.114</div></div>
                            <div class="dns-server" id="root"><span class="text-xl">ğŸŒ</span><br>æ ¹åŸŸåæœåŠ¡å™¨<div class="ip-address">198.41.0.4</div></div>
                            <div class="dns-server" id="tld"><span class="text-xl">ğŸ”</span><br>é¡¶çº§åŸŸåæœåŠ¡å™¨<div class="ip-address">192.5.6.30</div></div>
                            <div class="dns-server" id="auth"><span class="text-xl">ğŸ”‘</span><br>æƒé™åŸŸåæœåŠ¡å™¨<div class="ip-address">204.74.112.1</div></div>
                        </div>
                    </div>

                    <div id="explanation-box" class="min-h-[6rem] p-4 bg-blue-50 text-blue-800 border-l-4 border-blue-500 rounded-r-lg">
                        <p id="explanation-text" class="font-medium">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹æ¼”ç¤ºã€‚åŠ¨ç”»å°†åˆ†æ­¥å±•ç¤ºæŸ¥è¯¢æŠ¥æ–‡çš„æµåŠ¨è·¯å¾„ã€‚</p>
                    </div>

                    <div class="flex justify-center items-center gap-4 mt-8">
                        <button id="play-iterative" class="py-2 px-5 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-75">æ¼”ç¤ºè¿­ä»£æŸ¥è¯¢</button>
                        <button id="play-recursive" class="py-2 px-5 bg-teal-600 text-white font-semibold rounded-lg shadow-md hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-400 focus:ring-opacity-75">æ¼”ç¤ºé€’å½’æŸ¥è¯¢</button>
                        <button id="reset-animation" class="py-2 px-5 bg-slate-500 text-white font-semibold rounded-lg shadow-md hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-opacity-75">é‡ç½®åŠ¨ç”»</button>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tabs = document.querySelectorAll('.tab-btn');
            const contents = document.querySelectorAll('.tab-content');

            function setActiveTab(tabId) {
                tabs.forEach(tab => {
                    if (tab.getAttribute('data-tab') === tabId) {
                        tab.classList.add('active');
                    } else {
                        tab.classList.remove('active');
                    }
                });
                contents.forEach(content => {
                    if (content.id === tabId) {
                        content.classList.remove('hidden');
                    } else {
                        content.classList.add('hidden');
                    }
                });
            }

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    setActiveTab(tab.getAttribute('data-tab'));
                });
            });

            setActiveTab('overview');

            const treeNodes = document.querySelectorAll('.tree-node');
            const infoBox = document.getElementById('domain-info');
            treeNodes.forEach(node => {
                node.addEventListener('click', () => {
                    const info = node.getAttribute('data-info');
                    const nodeText = node.textContent;
                    infoBox.innerHTML = `
                        <h3 class="text-xl font-bold text-blue-700 mb-2">${nodeText}</h3>
                        <p class="text-slate-600">${info}</p>
                    `;
                });
            });

            const animContainer = document.getElementById('dns-animation-container');
            const explanationText = document.getElementById('explanation-text');
            const playIterativeBtn = document.getElementById('play-iterative');
            const playRecursiveBtn = document.getElementById('play-recursive');
            const resetBtn = document.getElementById('reset-animation');
            let isAnimating = false;
            let currentAnimation = null;

            const getServerElement = (id) => document.getElementById(id);

            function resetAnimationState() {
                isAnimating = false;
                if (currentAnimation) {
                    clearTimeout(currentAnimation);
                    currentAnimation = null;
                }
                document.querySelectorAll('.dns-server').forEach(el => el.classList.remove('active'));
                document.querySelectorAll('.message-packet').forEach(el => el.remove());
                explanationText.textContent = "ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®å¼€å§‹æ¼”ç¤ºã€‚åŠ¨ç”»å°†åˆ†æ­¥å±•ç¤ºæŸ¥è¯¢æŠ¥æ–‡çš„æµåŠ¨è·¯å¾„ã€‚";
                playIterativeBtn.disabled = false;
                playRecursiveBtn.disabled = false;
            }
            
            resetBtn.addEventListener('click', resetAnimationState);

            async function animateQuery(fromId, toId, text, packetText, isResponse = false) {
                return new Promise(resolve => {
                    const fromEl = getServerElement(fromId);
                    const toEl = getServerElement(toId);
                    fromEl.classList.add('active');
                    toEl.classList.add('active');

                    const fromRect = fromEl.getBoundingClientRect();
                    const toRect = toEl.getBoundingClientRect();
                    const containerRect = animContainer.getBoundingClientRect();

                    const packet = document.createElement('div');
                    packet.className = 'message-packet';
                    packet.innerHTML = `âœ‰ï¸ ${packetText}`;
                    packet.style.backgroundColor = isResponse ? '#10B981' : '#3B82F6';
                    
                    let startX = fromRect.left - containerRect.left + fromRect.width / 2;
                    let startY = fromRect.top - containerRect.top + fromRect.height / 2;
                    let endX = toRect.left - containerRect.left + toRect.width / 2;
                    let endY = toRect.top - containerRect.top + toRect.height / 2;
                    
                    packet.style.left = `${startX}px`;
                    packet.style.top = `${startY}px`;
                    packet.style.transform = `translate(-50%, -50%) scale(0.8)`;


                    animContainer.appendChild(packet);
                    explanationText.innerHTML = text;
                    
                    void packet.offsetWidth;

                    packet.style.opacity = '1';
                    packet.style.transform = `translate(calc(${endX - startX}px - 50%), calc(${endY - startY}px - 50%)) scale(1)`;

                    currentAnimation = setTimeout(() => {
                        packet.style.opacity = '0';
                        fromEl.classList.remove('active');
                        currentAnimation = setTimeout(() => {
                            toEl.classList.remove('active');
                            packet.remove();
                            resolve();
                        }, 300);
                    }, 1800);
                });
            }
            
            async function startIterativeAnimation() {
                if (isAnimating) return;
                resetAnimationState();
                isAnimating = true;
                playIterativeBtn.disabled = true;
                playRecursiveBtn.disabled = true;

                await animateQuery('client', 'local', '1. ä¸»æœº (192.168.1.101) å‘æœ¬åœ°åŸŸåæœåŠ¡å™¨ (114.114.114.114) å‘èµ·é€’å½’æŸ¥è¯¢ã€‚', 'æŸ¥è¯¢ y.abc.com');
                await animateQuery('local', 'root', '2. æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘æ ¹åŸŸåæœåŠ¡å™¨ (198.41.0.4) å‘èµ·è¿­ä»£æŸ¥è¯¢ã€‚', 'æŸ¥è¯¢ y.abc.com');
                await animateQuery('root', 'local', '3. æ ¹æœåŠ¡å™¨å›åº”ï¼šå»é—® .com é¡¶çº§åŸŸæœåŠ¡å™¨ (192.5.6.30)ã€‚', 'è½¬å‘è‡³ .com TLD', true);
                await animateQuery('local', 'tld', '4. æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘ .com é¡¶çº§åŸŸåæœåŠ¡å™¨æŸ¥è¯¢ã€‚', 'æŸ¥è¯¢ y.abc.com');
                await animateQuery('tld', 'local', '5. TLDæœåŠ¡å™¨å›åº”ï¼šå»é—® abc.com æƒé™æœåŠ¡å™¨ (204.74.112.1)ã€‚', 'è½¬å‘è‡³ abc.com NS', true);
                await animateQuery('local', 'auth', '6. æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘ abc.com æƒé™æœåŠ¡å™¨æŸ¥è¯¢ã€‚', 'æŸ¥è¯¢ y.abc.com');
                await animateQuery('auth', 'local', '7. æƒé™æœåŠ¡å™¨è¿”å› y.abc.com çš„IPåœ°å€ã€‚', 'IP: 216.58.221.110', true);
                await animateQuery('local', 'client', '8. æœ¬åœ°åŸŸåæœåŠ¡å™¨å°†IPåœ°å€è¿”å›ç»™ä¸»æœºã€‚', 'IP: 216.58.221.110', true);
                explanationText.innerHTML = "<span class='font-bold'>è¿­ä»£æŸ¥è¯¢å®Œæˆï¼</span> ä¸»æœºå·²è·å¾— y.abc.com çš„IPåœ°å€: 216.58.221.110ã€‚";
                
                isAnimating = false;
                playIterativeBtn.disabled = false;
                playRecursiveBtn.disabled = false;
            }

            async function startRecursiveAnimation() {
                if (isAnimating) return;
                resetAnimationState();
                isAnimating = true;
                playIterativeBtn.disabled = true;
                playRecursiveBtn.disabled = true;

                await animateQuery('client', 'local', '1. ä¸»æœº (192.168.1.101) å‘æœ¬åœ°åŸŸåæœåŠ¡å™¨ (114.114.114.114) å‘èµ·é€’å½’æŸ¥è¯¢ã€‚', 'æŸ¥è¯¢ y.abc.com');
                await animateQuery('local', 'root', '2. æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘æ ¹åŸŸåæœåŠ¡å™¨ (198.41.0.4) å‘èµ·é€’å½’æŸ¥è¯¢ã€‚', 'æŸ¥è¯¢ y.abc.com');
                await animateQuery('root', 'tld', '3. æ ¹æœåŠ¡å™¨ <span class="font-bold text-teal-700">ä»£ä¸º</span>å‘ .com é¡¶çº§åŸŸåæœåŠ¡å™¨æŸ¥è¯¢ã€‚', 'æŸ¥è¯¢ y.abc.com');
                await animateQuery('tld', 'auth', '4. TLDæœåŠ¡å™¨ <span class="font-bold text-teal-700">ä»£ä¸º</span>å‘ abc.com æƒé™æœåŠ¡å™¨æŸ¥è¯¢ã€‚', 'æŸ¥è¯¢ y.abc.com');
                await animateQuery('auth', 'tld', '5. æƒé™æœåŠ¡å™¨è¿”å›IPåœ°å€ç»™TLDæœåŠ¡å™¨ã€‚', 'IP: 216.58.221.110', true);
                await animateQuery('tld', 'root', '6. TLDæœåŠ¡å™¨å°†IPåœ°å€è¿”å›ç»™æ ¹æœåŠ¡å™¨ã€‚', 'IP: 216.58.221.110', true);
                await animateQuery('root', 'local', '7. æ ¹æœåŠ¡å™¨å°†IPåœ°å€è¿”å›ç»™æœ¬åœ°åŸŸåæœåŠ¡å™¨ã€‚', 'IP: 216.58.221.110', true);
                await animateQuery('local', 'client', '8. æœ¬åœ°åŸŸåæœåŠ¡å™¨å°†æœ€ç»ˆç»“æœè¿”å›ç»™ä¸»æœºã€‚', 'IP: 216.58.221.110', true);
                explanationText.innerHTML = "<span class='font-bold'>é€’å½’æŸ¥è¯¢å®Œæˆï¼</span> ä¸»æœºå·²è·å¾— y.abc.com çš„IPåœ°å€: 216.58.221.110ã€‚";
                
                isAnimating = false;
                playIterativeBtn.disabled = false;
                playRecursiveBtn.disabled = false;
            }

            playIterativeBtn.addEventListener('click', startIterativeAnimation);
            playRecursiveBtn.addEventListener('click', startRecursiveAnimation);
        });
    </script>
</body>
</html>
