<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº¤äº’å¼å­¦ä¹ ç¬”è®°ï¼šç¨‹åºçš„è£…å…¥ä¸é“¾æ¥</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: Calm Harmony (Background: #f5f5f4, Text: #333, Accent Blue: #60a5fa, Accent Green: #4ade80) -->
    <!-- Application Structure Plan: The application is structured as a four-part interactive guide: 1. Overview Diagram, 2. Program Loading, 3. Program Linking, 4. Comparison Table. This thematic, step-by-step approach was chosen over a linear text format to build a clear mental model for the user. It starts with a high-level process flow and then allows interactive deep-dives into each stage's methods. The interactive diagrams with step-by-step animations are central to making the abstract concepts of address translation and linking concrete and understandable. The final comparison table reinforces learning by summarizing key differences. -->
    <!-- Visualization & Content Choices:
    - Process Flow (Compile->Link->Load): Goal: Organize. Method: Interactive HTML/CSS diagram with clickable stages. Interaction: Clicks navigate to sections. Justification: Provides an immediate high-level overview and navigation hub.
    - Loading Methods (Absolute, Relocatable, Dynamic): Goal: Compare & Inform. Method: Tabbed sections with custom HTML/CSS/JS animated diagrams. Interaction: User clicks a "Simulate" button to trigger a step-by-step animation of address translation. Justification: Visually demonstrates the core difference in *when* and *how* logical addresses become physical addresses, which is the key concept.
    - Linking Methods (Static, Dynamic): Goal: Compare & Inform. Method: Similar tabbed/animated diagrams. Interaction: "Simulate" button shows modules being combined at different stages (before run, on load, on call). Justification: Clearly illustrates the timing and mechanism of linking, clarifying concepts like shared libraries and on-demand loading.
    - Comparison Table: Goal: Compare. Method: Standard HTML table. Interaction: None. Justification: Provides a concise, scannable summary for review and comparison of all methods.
    - Library/Method: All visualizations are custom-built using HTML, Tailwind CSS, and vanilla JavaScript. Chart.js is not needed. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif';
            background-color: #f8fafc; /* slate-50 */
        }
        .section-card {
            background-color: white;
            border-radius: 0.75rem;
            padding: 2rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            margin-bottom: 2rem;
            transition: all 0.3s ease-in-out;
        }
        .tab-button {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            border: 1px solid transparent;
        }
        .tab-button.active {
            background-color: #3b82f6; /* blue-500 */
            color: white;
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        }
        .tab-button:not(.active) {
            background-color: #e5e7eb; /* gray-200 */
            color: #374151; /* gray-700 */
        }
        .tab-button:not(.active):hover {
            background-color: #d1d5db; /* gray-300 */
        }
        .diagram-box {
            border: 2px solid #e5e7eb;
            background-color: #f9fafb;
            padding: 1rem;
            border-radius: 0.5rem;
            min-height: 12rem;
        }
        .address-box {
            font-family: 'Courier New', Courier, monospace;
            background-color: #f3f4f6;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            border: 1px solid #e5e7eb;
        }
        .memory-block {
            border: 1px solid #9ca3af;
            background-color: #f3f4f6;
            transition: all 0.5s ease;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .highlight-yellow {
            background-color: #fef08a !important; /* yellow-200 */
        }
        .highlight-blue {
            background-color: #bfdbfe !important; /* blue-200 */
        }
        .highlight-green {
            background-color: #bbf7d0 !important; /* green-200 */
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-900">ç¨‹åºçš„è£…å…¥ä¸é“¾æ¥</h1>
            <p class="mt-4 text-lg text-gray-600">ä¸€ä¸ªäº¤äº’å¼æŒ‡å—ï¼Œå¸¦æ‚¨äº†è§£ç¨‹åºå¦‚ä½•ä»ä»£ç å˜ä¸ºå†…å­˜ä¸­è¿è¡Œçš„è¿›ç¨‹ã€‚</p>
        </header>

        <!-- Section 1: Overview -->
        <section id="overview" class="section-card">
            <h2 class="text-2xl font-bold mb-4 text-center">ä»ä»£ç åˆ°å†…å­˜ï¼šå®Œæ•´æµç¨‹æ¦‚è§ˆ</h2>
            <p class="text-center text-gray-600 mb-8">ä¸€ä¸ªç”¨æˆ·ç¨‹åºè¦è¿è¡Œï¼Œé€šå¸¸éœ€è¦ç»è¿‡ç¼–è¯‘ã€é“¾æ¥å’Œè£…å…¥ä¸‰ä¸ªä¸»è¦æ­¥éª¤ã€‚ç‚¹å‡»ä¸‹æ–¹æµç¨‹ä¸­çš„ä»»æ„ç¯èŠ‚ï¼Œæ·±å…¥äº†è§£å…¶ç»†èŠ‚ã€‚</p>
            <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4">
                <div class="text-center p-4">
                    <div class="text-lg font-semibold">æºç¨‹åº (.c)</div>
                    <div class="text-3xl my-2">ğŸ’»</div>
                    <div class="font-mono text-sm bg-gray-100 p-2 rounded">`main() { ... }`</div>
                </div>
                <div class="text-5xl text-gray-400 font-light transform md:-translate-y-6">â†’</div>
                <div class="text-center p-4">
                    <div class="text-lg font-semibold">ç¼–è¯‘</div>
                    <div class="text-3xl my-2">âš™ï¸</div>
                    <div class="font-mono text-sm bg-gray-100 p-2 rounded">ç›®æ ‡æ¨¡å— (.o)</div>
                </div>
                <div class="text-5xl text-gray-400 font-light transform md:-translate-y-6">â†’</div>
                 <a href="#linking" class="text-center p-4 bg-blue-50 hover:bg-blue-100 rounded-lg transition cursor-pointer">
                    <div class="text-lg font-semibold text-blue-700">é“¾æ¥</div>
                    <div class="text-3xl my-2">ğŸ”—</div>
                    <div class="font-mono text-sm bg-blue-100 text-blue-800 p-2 rounded">è£…å…¥æ¨¡å—</div>
                </a>
                <div class="text-5xl text-gray-400 font-light transform md:-translate-y-6">â†’</div>
                <a href="#loading" class="text-center p-4 bg-green-50 hover:bg-green-100 rounded-lg transition cursor-pointer">
                    <div class="text-lg font-semibold text-green-700">è£…å…¥</div>
                    <div class="text-3xl my-2">ğŸ“¦</div>
                    <div class="font-mono text-sm bg-green-100 text-green-800 p-2 rounded">å†…å­˜ä¸­çš„è¿›ç¨‹</div>
                </a>
            </div>
        </section>

        <!-- Section 2: Program Loading -->
        <section id="loading" class="section-card">
            <h2 class="text-3xl font-bold mb-2">ç¬¬ 4.2.1 è®²ï¼šç¨‹åºçš„è£…å…¥ (Loading)</h2>
            <p class="text-gray-600 mb-6">è£…å…¥æ˜¯å°†è£…å…¥æ¨¡å—æ”¾å…¥å†…å­˜çš„è¿‡ç¨‹ã€‚ä¸åŒçš„è£…å…¥æ–¹å¼å†³å®šäº†ç¨‹åºé€»è¾‘åœ°å€å¦‚ä½•è½¬æ¢ä¸ºç‰©ç†åœ°å€ï¼Œç›´æ¥å½±å“ç¨‹åºçš„çµæ´»æ€§å’Œç³»ç»Ÿæ•ˆç‡ã€‚</p>
            
            <div class="flex space-x-2 mb-6 border-b pb-4">
                <button class="tab-button active" data-tab="loading-absolute">ç»å¯¹è£…å…¥</button>
                <button class="tab-button" data-tab="loading-relocatable">å¯é‡å®šä½è£…å…¥</button>
                <button class="tab-button" data-tab="loading-dynamic">åŠ¨æ€è¿è¡Œæ—¶è£…å…¥</button>
            </div>

            <div id="loading-content" class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                <!-- Content will be injected by JS -->
            </div>
        </section>

        <!-- Section 3: Program Linking -->
        <section id="linking" class="section-card">
            <h2 class="text-3xl font-bold mb-2">ç¬¬ 4.2.2 è®²ï¼šç¨‹åºçš„é“¾æ¥ (Linking)</h2>
            <p class="text-gray-600 mb-6">é“¾æ¥æ˜¯å°†å¤šä¸ªç¼–è¯‘åçš„ç›®æ ‡æ¨¡å—ä»¥åŠæ‰€éœ€çš„åº“å‡½æ•°ç»„åˆæˆä¸€ä¸ªå•ä¸€è£…å…¥æ¨¡å—çš„è¿‡ç¨‹ã€‚é“¾æ¥çš„æ—¶æœºå¯¹ç¨‹åºçš„æ›´æ–°ã€å…±äº«å’Œå†…å­˜ä½¿ç”¨æœ‰é‡å¤§å½±å“ã€‚</p>

            <div class="flex space-x-2 mb-6 border-b pb-4">
                <button class="tab-button active" data-tab="linking-static">é™æ€é“¾æ¥</button>
                <button class="tab-button" data-tab="linking-load-time">è£…å…¥æ—¶åŠ¨æ€é“¾æ¥</button>
                <button class="tab-button" data-tab="linking-run-time">è¿è¡Œæ—¶åŠ¨æ€é“¾æ¥</button>
            </div>
            
            <div id="linking-content" class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                <!-- Content will be injected by JS -->
            </div>
        </section>

        <!-- Section 4: Summary Table -->
        <section id="summary" class="section-card">
            <h2 class="text-3xl font-bold mb-6 text-center">å¯¹æ¯”ä¸æ€»ç»“</h2>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">æ–¹å¼</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">åœ°å€è½¬æ¢æ—¶æœº</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ä¼˜ç‚¹</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ç¼ºç‚¹</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <tr class="bg-blue-50"><td colspan="4" class="px-6 py-2 font-bold text-blue-800">è£…å…¥æ–¹å¼</td></tr>
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap font-medium">ç»å¯¹è£…å…¥</td>
                            <td class="px-6 py-4">ç¼–è¯‘æ—¶</td>
                            <td class="px-6 py-4">ç®€å•ï¼Œæ— éœ€åœ°å€è½¬æ¢</td>
                            <td class="px-6 py-4">çµæ´»æ€§å·®ï¼Œåªé€‚ç”¨äºå•é“ç¨‹åº</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap font-medium">å¯é‡å®šä½è£…å…¥</td>
                            <td class="px-6 py-4">è£…å…¥æ—¶ (é™æ€)</td>
                            <td class="px-6 py-4">é€‚ç”¨äºå¤šé“ç¨‹åºï¼Œå¯è£…å…¥ä»»æ„ä½ç½®</td>
                            <td class="px-6 py-4">ç¨‹åºåœ¨å†…å­˜ä¸­ä¸èƒ½ç§»åŠ¨</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap font-medium">åŠ¨æ€è¿è¡Œæ—¶è£…å…¥</td>
                            <td class="px-6 py-4">è¿è¡Œæ—¶ (åŠ¨æ€)</td>
                            <td class="px-6 py-4">ç¨‹åºå¯åœ¨å†…å­˜ä¸­ç§»åŠ¨ï¼Œä¾¿äºå†…å­˜ä¼˜åŒ–</td>
                            <td class="px-6 py-4">éœ€è¦ç¡¬ä»¶ï¼ˆé‡å®šä½å¯„å­˜å™¨ï¼‰æ”¯æŒ</td>
                        </tr>
                        <tr class="bg-green-50"><td colspan="4" class="px-6 py-2 font-bold text-green-800">é“¾æ¥æ–¹å¼</td></tr>
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap font-medium">é™æ€é“¾æ¥</td>
                            <td class="px-6 py-4">ç¨‹åºè¿è¡Œå‰</td>
                            <td class="px-6 py-4">æ‰§è¡Œé€Ÿåº¦å¿«ï¼Œæ— éœ€è¿è¡Œæ—¶é“¾æ¥å¼€é”€</td>
                            <td class="px-6 py-4">æ›´æ–°å›°éš¾ï¼Œæµªè´¹ç£ç›˜å’Œå†…å­˜ç©ºé—´</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap font-medium">è£…å…¥æ—¶åŠ¨æ€é“¾æ¥</td>
                            <td class="px-6 py-4">è£…å…¥æ—¶</td>
                            <td class="px-6 py-4">ä¾¿äºæ¨¡å—æ›´æ–°å’Œå…±äº«</td>
                            <td class="px-6 py-4">ç¨‹åºè£…å…¥è¿‡ç¨‹ç¨æ…¢</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap font-medium">è¿è¡Œæ—¶åŠ¨æ€é“¾æ¥</td>
                            <td class="px-6 py-4">é¦–æ¬¡è°ƒç”¨æ—¶</td>
                            <td class="px-6 py-4">èŠ‚çœå†…å­˜ï¼ŒåŠ å¿«ç¨‹åºå¯åŠ¨</td>
                            <td class="px-6 py-4">é¦–æ¬¡è°ƒç”¨æ¨¡å—æ—¶æœ‰å»¶è¿Ÿ</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

    </div>

<script>
const loadingContents = {
    'loading-absolute': {
        title: 'ç»å¯¹è£…å…¥æ–¹å¼ (Absolute Loading)',
        description: 'åœ¨å•é“ç¨‹åºç¯å¢ƒä¸‹ï¼Œç¼–è¯‘æ—¶å°±å°†ç¨‹åºçš„é€»è¾‘åœ°å€è½¬æ¢ä¸ºæœ€ç»ˆçš„ç‰©ç†åœ°å€ã€‚è£…å…¥æ—¶ç›´æ¥æŒ‰åœ°å€æ”¾å…¥å†…å­˜ï¼Œæ— éœ€ä»»ä½•ä¿®æ”¹ã€‚',
        features: ['é€‚ç”¨äºå•é“ç¨‹åºç¯å¢ƒ', 'ç¼–è¯‘æ—¶äº§ç”Ÿç‰©ç†åœ°å€', 'è£…å…¥è¿‡ç¨‹ç®€å•å¿«é€Ÿ', 'ç¨‹åºä¸èƒ½åœ¨å†…å­˜ä¸­ç§»åŠ¨'],
        diagram: `
            <div class="w-full">
                <h4 class="font-semibold mb-2">æ¨¡æ‹Ÿåœºæ™¯</h4>
                <div class="flex flex-col md:flex-row items-center justify-between space-y-4 md:space-y-0">
                    <div class="text-center">
                        <p class="font-semibold">è£…å…¥æ¨¡å— (å«ç‰©ç†åœ°å€)</p>
                        <div id="abs-module" class="diagram-box mt-2 w-48">
                           <div class="address-box">LOAD 1, 10100</div>
                           <div class="address-box mt-2">DATA 365 @ 12500</div>
                        </div>
                    </div>
                    <div id="abs-arrow" class="text-4xl text-gray-400 opacity-0 transition-opacity duration-500">â†’</div>
                    <div class="text-center">
                        <p class="font-semibold">å†…å­˜ç©ºé—´</p>
                        <div class="diagram-box mt-2 w-48 relative">
                           <div class="absolute top-1 left-1 text-xs text-gray-500">10000</div>
                           <div id="abs-mem" class="absolute left-2 right-2 opacity-0" style="top: 1rem;">
                               <div class="address-box memory-block">LOAD 1, 10100</div>
                           </div>
                           <div id="abs-mem-data" class="absolute left-2 right-2 opacity-0" style="top: 7rem;">
                               <div class="address-box memory-block">DATA 365</div>
                           </div>
                           <div class="absolute bottom-1 right-1 text-xs text-gray-500">15000</div>
                        </div>
                    </div>
                </div>
                <button id="abs-btn" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition w-full">æ¨¡æ‹Ÿè£…å…¥</button>
            </div>
        `
    },
    'loading-relocatable': {
        title: 'å¯é‡å®šä½è£…å…¥æ–¹å¼ (Relocatable Loading)',
        description: 'åœ¨å¤šé“ç¨‹åºç¯å¢ƒä¸‹ï¼Œç¼–è¯‘äº§ç”Ÿç›¸å¯¹åœ°å€ã€‚è£…å…¥æ—¶ï¼Œæ ¹æ®æ¨¡å—åœ¨å†…å­˜çš„èµ·å§‹åœ°å€ï¼Œä¸€æ¬¡æ€§åœ°å°†æ‰€æœ‰ç›¸å¯¹åœ°å€è½¬æ¢ä¸ºç‰©ç†åœ°å€ï¼ˆé™æ€é‡å®šä½ï¼‰ã€‚',
        features: ['é€‚ç”¨äºå¤šé“ç¨‹åºç¯å¢ƒ', 'è£…å…¥æ—¶è¿›è¡Œåœ°å€é‡å®šä½', 'ç¨‹åºè£…å…¥åä¸èƒ½åœ¨å†…å­˜ä¸­ç§»åŠ¨', 'æ— éœ€ç‰¹æ®Šç¡¬ä»¶æ”¯æŒ'],
        diagram: `
            <div class="w-full">
                <h4 class="font-semibold mb-2">æ¨¡æ‹Ÿåœºæ™¯ (èµ·å§‹åœ°å€: 10000)</h4>
                <div class="flex flex-col md:flex-row items-center justify-between space-y-4 md:space-y-0">
                    <div class="text-center">
                        <p class="font-semibold">è£…å…¥æ¨¡å— (ç›¸å¯¹åœ°å€)</p>
                        <div class="diagram-box mt-2 w-48">
                           <div class="address-box">LOAD 1, <span id="rel-logic" class="font-bold">2500</span></div>
                        </div>
                    </div>
                    <div class="text-center">
                        <div class="font-mono text-xl">+</div>
                        <div class="font-semibold">èµ·å§‹åœ°å€</div>
                        <div class="diagram-box mt-1 w-32 flex items-center justify-center">
                            <span id="rel-base" class="font-bold text-xl">10000</span>
                        </div>
                    </div>
                    <div class="text-center">
                        <p class="font-semibold">å†…å­˜ä¸­çš„ç‰©ç†åœ°å€</p>
                         <div class="diagram-box mt-2 w-48 flex items-center justify-center">
                            <span id="rel-phys" class="font-bold text-xl opacity-0">?</span>
                         </div>
                    </div>
                </div>
                <button id="rel-btn" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition w-full">æ¨¡æ‹Ÿé‡å®šä½</button>
            </div>
        `
    },
    'loading-dynamic': {
        title: 'åŠ¨æ€è¿è¡Œæ—¶è£…å…¥æ–¹å¼ (Dynamic Run-time Loading)',
        description: 'åœ°å€è½¬æ¢æ¨è¿Ÿåˆ°ç¨‹åºè¿è¡Œæ—¶æ‰è¿›è¡Œã€‚CPUæ¯æ¬¡è®¿é—®å†…å­˜ï¼Œç¡¬ä»¶ï¼ˆé‡å®šä½å¯„å­˜å™¨ï¼‰éƒ½ä¼šåŠ¨æ€åœ°å°†é€»è¾‘åœ°å€åŠ ä¸Šç¨‹åºåŸºå€ï¼Œå½¢æˆç‰©ç†åœ°å€ã€‚',
        features: ['ç¨‹åºå¯åœ¨å†…å­˜ä¸­ç§»åŠ¨', 'å†…å­˜åˆ©ç”¨ç‡é«˜', 'éœ€è¦é‡å®šä½å¯„å­˜å™¨ç¡¬ä»¶æ”¯æŒ', 'æ˜¯å®ç°è™šæ‹Ÿå†…å­˜çš„åŸºç¡€'],
        diagram: `
            <div class="w-full">
                <h4 class="font-semibold mb-2">æ¨¡æ‹Ÿåœºæ™¯</h4>
                <div class="flex flex-col md:flex-row items-center justify-between space-y-4 md:space-y-0">
                    <div class="text-center">
                        <p class="font-semibold">CPUå‘å‡ºé€»è¾‘åœ°å€</p>
                        <div class="diagram-box mt-2 w-48 flex items-center justify-center">
                           <span class="font-bold text-xl">2500</span>
                        </div>
                    </div>
                     <div class="text-center">
                        <div class="font-mono text-xl">+</div>
                        <p class="font-semibold">é‡å®šä½å¯„å­˜å™¨</p>
                        <div class="diagram-box mt-1 w-32 flex items-center justify-center">
                           <span id="dyn-base" class="font-bold text-xl">10000</span>
                        </div>
                    </div>
                    <div class="text-center">
                        <p class="font-semibold">æœ€ç»ˆç‰©ç†åœ°å€</p>
                        <div class="diagram-box mt-2 w-48 flex items-center justify-center">
                           <span id="dyn-phys" class="font-bold text-xl">12500</span>
                        </div>
                    </div>
                </div>
                <div class="mt-4">
                    <label for="relocation-value" class="font-semibold">æ¨¡æ‹Ÿç¨‹åºç§»åŠ¨ (ä¿®æ”¹é‡å®šä½å¯„å­˜å™¨):</label>
                    <input type="range" id="relocation-value" min="0" max="50000" step="1000" value="10000" class="w-full mt-2">
                </div>
            </div>
        `
    }
};

const linkingContents = {
    'linking-static': {
        title: 'é™æ€é“¾æ¥ (Static Linking)',
        description: 'åœ¨ç¨‹åºè¿è¡Œå‰ï¼Œé“¾æ¥å™¨å°†æ‰€æœ‰ç›®æ ‡æ¨¡å—ï¼ˆ.oï¼‰å’Œåº“å‡½æ•°ç»„åˆæˆä¸€ä¸ªå•ä¸€ã€å®Œæ•´çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚',
        features: ['é“¾æ¥åœ¨è¿è¡Œå‰å®Œæˆ', 'æ‰€æœ‰ä»£ç å’Œæ•°æ®æ‰“åŒ…åœ¨ä¸€èµ·', 'æ›´æ–°ä¸ä¾¿ï¼Œéœ€é‡æ–°é“¾æ¥æ•´ä¸ªç¨‹åº', 'æµªè´¹ç©ºé—´ï¼Œå› å¤šä¸ªç¨‹åºå¯èƒ½åŒ…å«ç›¸åŒåº“çš„å‰¯æœ¬'],
        diagram: `
            <div class="w-full">
                 <div id="static-link-diagram" class="flex flex-col items-center space-y-2">
                    <div class="flex space-x-2">
                        <div id="s-mod-a" class="diagram-box w-24 h-16 flex items-center justify-center">æ¨¡å—A</div>
                        <div id="s-mod-b" class="diagram-box w-24 h-16 flex items-center justify-center">æ¨¡å—B</div>
                        <div id="s-mod-lib" class="diagram-box w-24 h-16 flex items-center justify-center">åº“å‡½æ•°</div>
                    </div>
                    <div id="s-arrow" class="text-3xl text-gray-400 opacity-0">â†“</div>
                    <div id="s-exe" class="diagram-box w-80 h-24 flex items-center justify-center text-lg font-bold bg-green-100 opacity-0">
                        å®Œæ•´çš„å¯æ‰§è¡Œæ–‡ä»¶
                    </div>
                 </div>
                 <button id="static-btn" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition w-full">æ¨¡æ‹Ÿé“¾æ¥</to-do>
            </div>
        `
    },
    'linking-load-time': {
        title: 'è£…å…¥æ—¶åŠ¨æ€é“¾æ¥ (Load-time Dynamic Linking)',
        description: 'åœ¨ç¨‹åºå¼€å§‹è£…å…¥å†…å­˜æ—¶ï¼Œæ‰è¿›è¡Œé“¾æ¥ã€‚è£…å…¥ç¨‹åºåœ¨é‡åˆ°å¤–éƒ¨å¼•ç”¨æ—¶ï¼Œä¼šæŸ¥æ‰¾å¹¶è£…å…¥ç›¸åº”æ¨¡å—ï¼Œç„¶åå®Œæˆé“¾æ¥ã€‚',
        features: ['é“¾æ¥åœ¨è£…å…¥æ—¶è¿›è¡Œ', 'ä¾¿äºæ¨¡å—æ›´æ–°å’Œç»´æŠ¤', 'å¯å®ç°æ¨¡å—å…±äº«ï¼ŒèŠ‚çœå†…å­˜', 'ç¨‹åºå¯åŠ¨ç¨æ…¢'],
        diagram: `
            <div class="w-full">
                 <p class="text-center mb-4"><strong>çŠ¶æ€:</strong> <span id="load-status">ç­‰å¾…è£…å…¥...</span></p>
                 <div class="flex justify-around items-start">
                    <div class="text-center">
                        <p class="font-semibold">å¾…è£…å…¥æ¨¡å—</p>
                        <div class="space-y-2 mt-2">
                            <div id="lt-mod-a" class="diagram-box w-32">ä¸»æ¨¡å— A</div>
                            <div id="lt-mod-b" class="diagram-box w-32">æ¨¡å— B</div>
                        </div>
                    </div>
                    <div class="text-center">
                        <p class="font-semibold">å†…å­˜</p>
                        <div id="lt-mem" class="diagram-box w-48 h-48 mt-2 space-y-2"></div>
                    </div>
                 </div>
                 <button id="load-time-btn" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition w-full">æ¨¡æ‹Ÿè£…å…¥ä¸é“¾æ¥</to-do>
            </div>
        `
    },
    'linking-run-time': {
        title: 'è¿è¡Œæ—¶åŠ¨æ€é“¾æ¥ (Run-time Dynamic Linking)',
        description: 'é“¾æ¥å·¥ä½œæ¨è¿Ÿåˆ°ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå½“ç¬¬ä¸€æ¬¡éœ€è¦è°ƒç”¨æŸä¸ªæ¨¡å—æ—¶æ‰è¿›è¡Œã€‚è¿™æ˜¯æœ€çµæ´»çš„æ–¹å¼ã€‚',
        features: ['åœ¨é¦–æ¬¡è°ƒç”¨æ—¶é“¾æ¥', 'æå¤§èŠ‚çœå†…å­˜ï¼ŒæŒ‰éœ€åŠ è½½', 'ç¨‹åºå¯åŠ¨é€Ÿåº¦å¿«', 'æ”¯æŒæ’ä»¶å’Œçƒ­æ›´æ–°'],
        diagram: `
            <div class="w-full">
                <p class="text-center mb-4"><strong>çŠ¶æ€:</strong> <span id="run-status">ç¨‹åºå·²å¯åŠ¨ï¼Œæ­£åœ¨æ‰§è¡Œä¸»æ¨¡å—...</span></p>
                 <div class="flex justify-around items-start">
                    <div class="text-center">
                        <p class="font-semibold">ç£ç›˜ä¸Šçš„æ¨¡å—</p>
                        <div class="space-y-2 mt-2">
                            <div class="diagram-box w-32">æ¨¡å— B</div>
                        </div>
                    </div>
                    <div class="text-center">
                        <p class="font-semibold">å†…å­˜</p>
                        <div id="rt-mem" class="diagram-box w-48 h-48 mt-2 space-y-2">
                            <div class="p-2 text-center memory-block highlight-green">ä¸»æ¨¡å— A</div>
                        </div>
                    </div>
                 </div>
                 <button id="run-time-btn" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition w-full">æ¨¡æ‹Ÿè°ƒç”¨æ¨¡å—B</button>
            </div>
        `
    }
};

function setupTabs(containerId, contentObj, defaultTab) {
    const tabContainer = document.querySelector(`#${containerId}`);
    const contentContainer = document.querySelector(`#${containerId}-content`);

    function renderContent(tabName) {
        const content = contentObj[tabName];
        contentContainer.innerHTML = `
            <div class="prose max-w-none">
                <h3 class="text-2xl font-semibold text-gray-800">${content.title}</h3>
                <p class="text-gray-600">${content.description}</p>
                <ul class="list-disc pl-5 space-y-1 mt-4">
                    ${content.features.map(f => `<li>${f}</li>`).join('')}
                </ul>
            </div>
            <div class="mt-6 md:mt-0">${content.diagram}</div>
        `;
        attachEventListeners(tabName);
    }

    tabContainer.addEventListener('click', (e) => {
        if (e.target.classList.contains('tab-button')) {
            tabContainer.querySelector('.active').classList.remove('active');
            e.target.classList.add('active');
            renderContent(e.target.dataset.tab);
        }
    });

    renderContent(defaultTab);
}

function attachEventListeners(tabName) {
    switch(tabName) {
        case 'loading-absolute':
            document.getElementById('abs-btn').addEventListener('click', () => {
                const arrow = document.getElementById('abs-arrow');
                const mem = document.getElementById('abs-mem');
                const mem_data = document.getElementById('abs-mem-data');
                const btn = document.getElementById('abs-btn');

                btn.disabled = true;
                btn.textContent = 'è£…å…¥ä¸­...';
                arrow.classList.remove('opacity-0');
                
                setTimeout(() => {
                    mem.classList.add('opacity-100', 'fade-in');
                }, 500);
                 setTimeout(() => {
                    mem_data.classList.add('opacity-100', 'fade-in');
                    mem.querySelector('.memory-block').classList.add('highlight-yellow');
                    mem_data.querySelector('.memory-block').classList.add('highlight-yellow');
                }, 1000);
                setTimeout(() => {
                     btn.textContent = 'è£…å…¥å®Œæˆ';
                }, 1500);
            });
            break;
        case 'loading-relocatable':
            document.getElementById('rel-btn').addEventListener('click', () => {
                const logic = document.getElementById('rel-logic');
                const base = document.getElementById('rel-base');
                const phys = document.getElementById('rel-phys');
                const btn = document.getElementById('rel-btn');

                btn.disabled = true;
                btn.textContent = 'è®¡ç®—ä¸­...';
                logic.parentElement.classList.add('highlight-yellow');
                base.parentElement.classList.add('highlight-blue');
                
                setTimeout(() => {
                    phys.textContent = parseInt(logic.textContent) + parseInt(base.textContent);
                    phys.classList.remove('opacity-0');
                    phys.parentElement.classList.add('highlight-green');
                    btn.textContent = 'é‡å®šä½å®Œæˆ';
                }, 1000);
            });
            break;
        case 'loading-dynamic':
            document.getElementById('relocation-value').addEventListener('input', (e) => {
                 const logic = 2500;
                 const baseEl = document.getElementById('dyn-base');
                 const physEl = document.getElementById('dyn-phys');
                 baseEl.textContent = e.target.value;
                 physEl.textContent = logic + parseInt(e.target.value);

                 baseEl.parentElement.classList.add('highlight-yellow');
                 physEl.parentElement.classList.add('highlight-green');
                 setTimeout(() => {
                    baseEl.parentElement.classList.remove('highlight-yellow');
                    physEl.parentElement.classList.remove('highlight-green');
                 }, 500);
            });
            break;
        case 'linking-static':
             document.getElementById('static-btn').addEventListener('click', () => {
                const btn = document.getElementById('static-btn');
                btn.disabled = true;
                btn.textContent = 'é“¾æ¥ä¸­...';
                document.getElementById('s-mod-a').classList.add('highlight-yellow');
                document.getElementById('s-mod-b').classList.add('highlight-yellow');
                document.getElementById('s-mod-lib').classList.add('highlight-yellow');
                
                setTimeout(() => {
                    document.getElementById('s-arrow').classList.remove('opacity-0');
                }, 500);

                setTimeout(() => {
                    document.getElementById('s-exe').classList.remove('opacity-0');
                    document.getElementById('s-exe').classList.add('fade-in');
                    btn.textContent = 'é“¾æ¥å®Œæˆ';
                }, 1000);
             });
            break;
        case 'linking-load-time':
            document.getElementById('load-time-btn').addEventListener('click', () => {
                const btn = document.getElementById('load-time-btn');
                const status = document.getElementById('load-status');
                const mem = document.getElementById('lt-mem');
                btn.disabled = true;
                mem.innerHTML = '';
                
                status.textContent = "æ­£åœ¨è£…å…¥ä¸»æ¨¡å— A...";
                setTimeout(() => {
                    const modA = document.createElement('div');
                    modA.className = 'p-2 text-center memory-block highlight-green fade-in';
                    modA.textContent = 'ä¸»æ¨¡å— A';
                    mem.appendChild(modA);
                }, 500);

                setTimeout(() => {
                    status.textContent = "å‘ç°å¤–éƒ¨è°ƒç”¨ï¼Œæ­£åœ¨è£…å…¥å¹¶é“¾æ¥æ¨¡å— B...";
                }, 1500);

                 setTimeout(() => {
                    const modB = document.createElement('div');
                    modB.className = 'p-2 text-center memory-block highlight-blue fade-in';
                    modB.textContent = 'æ¨¡å— B';
                    mem.appendChild(modB);
                    status.textContent = "è£…å…¥å’Œé“¾æ¥å®Œæˆï¼";
                    btn.disabled = false;
                }, 2000);
            });
            break;
        case 'linking-run-time':
             document.getElementById('run-time-btn').addEventListener('click', () => {
                const btn = document.getElementById('run-time-btn');
                const status = document.getElementById('run-status');
                const mem = document.getElementById('rt-mem');

                if (mem.children.length > 1) {
                    status.textContent = "æ¨¡å— B å·²åœ¨å†…å­˜ä¸­ã€‚";
                    return;
                }

                btn.disabled = true;
                btn.textContent = 'è°ƒç”¨ä¸­...';
                status.textContent = "ä¸»æ¨¡å—è¯·æ±‚è°ƒç”¨æ¨¡å— B...";

                setTimeout(() => {
                    status.textContent = "ç³»ç»ŸæŸ¥æ‰¾ã€è£…å…¥å¹¶é“¾æ¥æ¨¡å— B...";
                    const modB = document.createElement('div');
                    modB.className = 'p-2 text-center memory-block highlight-blue fade-in';
                    modB.textContent = 'æ¨¡å— B';
                    mem.appendChild(modB);
                }, 1000);

                setTimeout(() => {
                    status.textContent = "æ¨¡å— B é“¾æ¥å®Œæˆï¼Œç¨‹åºç»§ç»­æ‰§è¡Œã€‚";
                    btn.textContent = 'æ¨¡æ‹Ÿè°ƒç”¨æ¨¡å—B';
                    btn.disabled = false;
                }, 2000);
             });
            break;
    }
}


document.addEventListener('DOMContentLoaded', () => {
    setupTabs('loading', loadingContents, 'loading-absolute');
    setupTabs('linking', linkingContents, 'linking-static');

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            document.querySelector(this.getAttribute('href')).scrollIntoView({
                behavior: 'smooth'
            });
        });
    });
});
</script>

</body>
</html>
